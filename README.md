# ğŸŒ± AIOT Smart Greenhouse System

Há»‡ thá»‘ng nhÃ  kÃ­nh thÃ´ng minh sá»­ dá»¥ng cÃ´ng nghá»‡ AIOT (Artificial Intelligence of Things) Ä‘á»ƒ giÃ¡m sÃ¡t vÃ  Ä‘iá»u khiá»ƒn tá»± Ä‘á»™ng mÃ´i trÆ°á»ng nhÃ  kÃ­nh vá»›i kháº£ nÄƒng Ä‘iá»u khiá»ƒn báº±ng giá»ng nÃ³i.

## ğŸ‘¥ MEMBERS
1. Nguyen Van Le Ba Thanh - 22127390
2. Nguyen Gia Kiet - 22127221
3. Nguyen Hoang Nhu - 22127314
4. Vo Thanh Tu - 21127469

## ğŸ—ï¸ Kiáº¿n trÃºc há»‡ thá»‘ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚   Backend       â”‚    â”‚   Database      â”‚
â”‚   (Next.js)     â”‚â—„â”€â”€â–ºâ”‚   (Node.js)     â”‚â—„â”€â”€â–ºâ”‚   (MongoDB)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       
         â”‚                       â”‚                       
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
         â”‚              â”‚   MQTT Broker   â”‚              
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   (Mosquitto)   â”‚              
                        â”‚   Port: 1883    â”‚              
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              
                                 â”‚                        
                                 â”‚                        
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              
                        â”‚   IoT Devices   â”‚              
                        â”‚   (Arduino/ESP) â”‚              
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              
```

## ğŸš€ TÃ­nh nÄƒng chÃ­nh

### ğŸ“Š GiÃ¡m sÃ¡t thá»i gian thá»±c
- **Nhiá»‡t Ä‘á»™**: Theo dÃµi nhiá»‡t Ä‘á»™ mÃ´i trÆ°á»ng
- **Äá»™ áº©m**: GiÃ¡m sÃ¡t Ä‘á»™ áº©m khÃ´ng khÃ­
- **Äá»™ áº©m Ä‘áº¥t**: Äo Ä‘á»™ áº©m trong Ä‘áº¥t
- **Má»±c nÆ°á»›c**: Kiá»ƒm tra má»±c nÆ°á»›c trong bá»“n
- **Chiá»u cao cÃ¢y**: Theo dÃµi sá»± phÃ¡t triá»ƒn cá»§a cÃ¢y
- **Tráº¡ng thÃ¡i mÆ°a**: Cáº£m biáº¿n phÃ¡t hiá»‡n mÆ°a

### ğŸ›ï¸ Äiá»u khiá»ƒn tá»± Ä‘á»™ng
- **ÄÃ¨n LED**: Tá»± Ä‘á»™ng báº­t/táº¯t theo lá»‹ch vÃ  cÆ°á»ng Ä‘á»™ Ã¡nh sÃ¡ng
- **Há»‡ thá»‘ng tÆ°á»›i**: Äiá»u khiá»ƒn bÆ¡m nÆ°á»›c dá»±a trÃªn Ä‘á»™ áº©m Ä‘áº¥t
- **Cá»­a thÃ´ng giÃ³**: Má»Ÿ/Ä‘Ã³ng tá»± Ä‘á»™ng Ä‘á»ƒ Ä‘iá»u hÃ²a nhiá»‡t Ä‘á»™
- **Äiá»u khiá»ƒn giá»ng nÃ³i**: TÃ­ch há»£p AI voice control

### ğŸ”” Há»‡ thá»‘ng cáº£nh bÃ¡o thÃ´ng minh
- **GiÃ¡m sÃ¡t ngÆ°á»¡ng**: Kiá»ƒm tra thá»i gian thá»±c cÃ¡c thÃ´ng sá»‘ cáº£m biáº¿n
- **Cáº£nh bÃ¡o email**: Gá»­i email HTML Ä‘áº¹p máº¯t khi vÆ°á»£t ngÆ°á»¡ng
- **Nhiá»u má»©c Ä‘á»™**: Critical, High, Medium, Low alerts
- **Chá»‘ng spam**: Cooldown 5 phÃºt giá»¯a cÃ¡c cáº£nh bÃ¡o
- **Äa ngÆ°á»i nháº­n**: Há»— trá»£ nhiá»u email recipients
- **Test email**: Kiá»ƒm tra cáº¥u hÃ¬nh email
- **LÆ°u trá»¯ lá»‹ch sá»­**: Theo dÃµi táº¥t cáº£ cáº£nh bÃ¡o trong database
- **Cáº¥u hÃ¬nh linh hoáº¡t**: Äiá»u chá»‰nh ngÆ°á»¡ng tá»« frontend

### ğŸ“ˆ BÃ¡o cÃ¡o vÃ  thá»‘ng kÃª
- Biá»ƒu Ä‘á»“ thá»i gian thá»±c
- BÃ¡o cÃ¡o lá»‹ch sá»­
- Thá»‘ng kÃª theo ngÃ y/tuáº§n/thÃ¡ng
- Export dá»¯ liá»‡u

## ğŸ› ï¸ CÃ´ng nghá»‡ sá»­ dá»¥ng

### Frontend
- **Next.js 13**: React framework vá»›i App Router
- **TypeScript**: Type-safe development
- **Bootstrap**: UI framework
- **Chart.js**: Biá»ƒu Ä‘á»“ vÃ  visualization
- **React**: User interface library

### Backend
- **Node.js**: Runtime environment
- **Express.js**: Web framework
- **TypeScript**: Type-safe server development
- **MongoDB**: NoSQL database
- **Mongoose**: MongoDB object modeling
- **MQTT**: IoT messaging protocol
- **Zod**: Schema validation
- **JWT**: Authentication (thay tháº¿ Firebase Auth)

### Infrastructure
- **Docker**: Containerization
- **Docker Compose**: Multi-container deployment
- **Mosquitto**: MQTT broker
- **MongoDB**: Database storage (thay tháº¿ ThingSpeak)

### Hardware
- **Arduino/ESP32**: Microcontroller
- **DHT22**: Temperature & humidity sensor
- **Soil moisture sensor**: Cáº£m biáº¿n Ä‘á»™ áº©m Ä‘áº¥t
- **Ultrasonic sensor**: Äo khoáº£ng cÃ¡ch/má»±c nÆ°á»›c
- **Rain sensor**: Cáº£m biáº¿n mÆ°a
- **Relay modules**: Äiá»u khiá»ƒn thiáº¿t bá»‹

## ğŸ“‹ YÃªu cáº§u há»‡ thá»‘ng

- **Docker & Docker Compose**
- **Node.js 18+** (cho development)
- **Git**
- **Web browser** há»— trá»£ modern JavaScript

## ğŸš€ CÃ i Ä‘áº·t vÃ  cháº¡y

### 1. Clone repository
```bash
git clone <repository-url>
cd aiot-smart-greenhouse
```

### 2. Cáº¥u hÃ¬nh mÃ´i trÆ°á»ng
```bash
# Copy file cáº¥u hÃ¬nh
cp .env.example .env

# Chá»‰nh sá»­a file .env theo nhu cáº§u
```

### 3. Cháº¡y há»‡ thá»‘ng

#### ğŸ³ Sá»­ dá»¥ng Docker (Khuyáº¿n nghá»‹)
```bash
# Cháº¡y toÃ n bá»™ há»‡ thá»‘ng
docker compose up -d

# Xem logs
docker compose logs -f
```

### ğŸ› ï¸ Available Scripts

#### ï¿½ Development
```bash
# Windows - Start development environment
.\scripts\start-dev.ps1

# Stop development environment  
.\scripts\stop-dev.ps1

# Test system health
.\scripts\test-system.ps1
```

#### ğŸ­ Production
```bash
# Start production environment
.\scripts\start-prod.ps1

# Stop production environment
.\scripts\stop-prod.ps1

# Create production backup
.\scripts\backup-prod.ps1
```

#### ğŸ§¹ Maintenance
```bash
# Clean project artifacts
.\scripts\clean-project.ps1

# Initialize system with admin user
.\scripts\init-system.ps1

# Setup MQTT user authentication
.\scripts\setup-mqtt-user.ps1

# Test MQTT authentication
.\scripts\test-mqtt-auth.ps1
```

### ğŸ” MQTT Authentication Process

The MQTT setup follows a secure process:

1. **Initial Setup**: MQTT starts with anonymous access enabled
2. **User Creation**: Default user 'vision' is created with password authentication
3. **Security Lock**: Anonymous access is disabled, authentication required
4. **Verification**: Connection is tested to ensure proper authentication

This ensures MQTT broker is always properly secured after initialization.

### 4. ÄÄƒng nháº­p há»‡ thá»‘ng

**Default Admin Account:**
- ğŸ‘¤ **Username:** `admin`
- ğŸ” **Password:** `admin`

**URLs:**
- ğŸŒ **Frontend:** http://localhost:3000
- ğŸ”§ **Backend API:** http://localhost:5000
- ğŸ“Š **Health Check:** http://localhost:5000/api/health

**MQTT Credentials (Development):**
- ğŸ‘¤ **Username:** `vision`
- ğŸ” **Password:** `vision`

> âš ï¸ **LÆ°u Ã½:** Trong mÃ´i trÆ°á»ng production, hÃ£y thay Ä‘á»•i máº­t kháº©u admin vÃ  MQTT ngay láº­p tá»©c!

## ğŸ“¡ API Endpoints

### Sensors
| Method | Endpoint | MÃ´ táº£ |
|--------|----------|-------|
| GET | `/api/sensors` | Láº¥y dá»¯ liá»‡u cáº£m biáº¿n |
| GET | `/api/sensors/latest` | Dá»¯ liá»‡u cáº£m biáº¿n má»›i nháº¥t |
| GET | `/api/sensors/stats` | Thá»‘ng kÃª cáº£m biáº¿n |

### Devices
| Method | Endpoint | MÃ´ táº£ |
|--------|----------|-------|
| GET | `/api/devices` | Láº¥y tráº¡ng thÃ¡i thiáº¿t bá»‹ |
| POST | `/api/devices/control` | Äiá»u khiá»ƒn thiáº¿t bá»‹ |

### History
| Method | Endpoint | MÃ´ táº£ |
|--------|----------|-------|
| GET | `/api/history` | Láº¥y dá»¯ liá»‡u lá»‹ch sá»­ |
| GET | `/api/history/summary` | TÃ³m táº¯t lá»‹ch sá»­ |

### Settings
| Method | Endpoint | MÃ´ táº£ |
|--------|----------|-------|
| GET | `/api/settings` | Láº¥y cÃ i Ä‘áº·t |
| POST | `/api/settings` | Cáº­p nháº­t cÃ i Ä‘áº·t |

### Alerts
| Method | Endpoint | MÃ´ táº£ |
|--------|----------|-------|
| GET | `/api/alerts` | Láº¥y danh sÃ¡ch cáº£nh bÃ¡o |
| GET | `/api/alerts/active` | Cáº£nh bÃ¡o chÆ°a xá»­ lÃ½ |

## ğŸ¦Ÿ MQTT Topics

### Sensor Data (Subscribe)
| Topic | MÃ´ táº£ |
|-------|-------|
| `greenhouse/sensors/temperature` | Nhiá»‡t Ä‘á»™ |
| `greenhouse/sensors/humidity` | Äá»™ áº©m khÃ´ng khÃ­ |
| `greenhouse/sensors/soil` | Äá»™ áº©m Ä‘áº¥t |
| `greenhouse/sensors/water` | Má»±c nÆ°á»›c |
| `greenhouse/sensors/height` | Chiá»u cao cÃ¢y |
| `greenhouse/sensors/rain` | Tráº¡ng thÃ¡i mÆ°a |

### Device Control (Publish)
| Topic | MÃ´ táº£ |
|-------|-------|
| `greenhouse/devices/light/control` | Äiá»u khiá»ƒn Ä‘Ã¨n |
| `greenhouse/devices/pump/control` | Äiá»u khiá»ƒn bÆ¡m |
| `greenhouse/devices/door/control` | Äiá»u khiá»ƒn cá»­a |

## ğŸ”§ Cáº¥u hÃ¬nh

### Biáº¿n mÃ´i trÆ°á»ng chÃ­nh
```env
# Database
MONGODB_USER=greenhouse_user
MONGODB_PASSWORD=greenhouse_password

# MQTT (Báº£o máº­t vá»›i authentication)
MQTT_USERNAME=vision
MQTT_PASSWORD=vision

# Application
NODE_ENV=development
```

### ğŸ” MQTT Authentication

Há»‡ thá»‘ng sá»­ dá»¥ng MQTT authentication Ä‘á»ƒ báº£o máº­t:

- **Default Username**: `vision`
- **Default Password**: `vision`
- **Anonymous access**: ÄÃ£ bá»‹ táº¯t
- **Password file**: `mosquitto/config/passwd`

#### Thay Ä‘á»•i MQTT password:

```bash
# Táº¡o password má»›i vá»›i mosquitto_passwd
mosquitto_passwd -c mosquitto/config/passwd your_username

# Cáº­p nháº­t .env file
MQTT_USERNAME=your_username
MQTT_PASSWORD=your_new_password
```

#### Test MQTT connection:

```bash
# Test publish
mosquitto_pub -h localhost -u vision -P vision -t "test/topic" -m "Hello"

# Test subscribe
mosquitto_sub -h localhost -u vision -P vision -t "test/topic"
```

## ğŸ“š TÃ i liá»‡u

- [Backend API Documentation](./backend/README.md)
- [Frontend Documentation](./frontend/README.md)
- [Hardware Setup Guide](./embedded/README.md)
- [MQTT Authentication Guide](./docs/MQTT_AUTH.md)

## ğŸ¤ ÄÃ³ng gÃ³p

1. Fork repository
2. Táº¡o feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Táº¡o Pull Request

---

â­ **Náº¿u dá»± Ã¡n nÃ y há»¯u Ã­ch, hÃ£y cho má»™t star Ä‘á»ƒ á»§ng há»™!** â­
